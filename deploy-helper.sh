#!/bin/bash

echo "ğŸš€ Collectiva Deployment Helper"
echo "==============================="
echo ""

# Check if git remote exists
if git remote get-url origin > /dev/null 2>&1; then
    echo "âœ… Git remote already configured"
    echo "Current remote: $(git remote get-url origin)"
    echo ""
    echo "âš ï¸  IMPORTANT: Check if your repository is PUBLIC"
    echo "   Vercel free tier requires public repositories!"
    echo ""
    echo "To make your repository public:"
    echo "1. Go to: $(git remote get-url origin)"
    echo "2. Click Settings â†’ Scroll down to 'Danger Zone'"
    echo "3. Click 'Change repository visibility' â†’ 'Make public'"
    echo "4. Type repository name to confirm"
else
    echo "âš ï¸  No Git remote found"
    echo ""
    echo "Please follow these steps:"
    echo "1. Create a new repository on GitHub.com"
    echo "2. Repository name: collectiva"
    echo "3. âš ï¸  IMPORTANT: Make it PUBLIC (required for Vercel free tier)"
    echo "4. Then run:"
    echo ""
    echo "   git remote add origin https://github.com/YOUR_USERNAME/collectiva.git"
    echo "   git push -u origin main"
    echo ""
fi

echo ""
echo "ğŸ“‹ Deployment Checklist:"
echo "========================"
echo ""
echo "âœ… GitHub repository created"
echo "âœ… Code pushed to GitHub"
echo "âœ… Vercel account created"
echo "âœ… Repository imported to Vercel"
echo "âœ… First deployment completed"
echo ""
echo "ğŸ¯ Next Development Phase:"
echo "========================="
echo "âœ… Database setup (PostgreSQL)"
echo "âœ… Authentication system (NextAuth.js)"
echo "âœ… Real user registration"
echo "ğŸ”„ Database deployment (Vercel Postgres) - IN PROGRESS"
echo "â–¡ Organization management"
echo "â–¡ Payment integration (Stripe)"
echo "â–¡ AI fund distribution"
echo ""
echo "ğŸš€ IMMEDIATE NEXT STEP:"
echo "1. Go to Vercel Dashboard â†’ Storage â†’ Create Postgres DB"
echo "2. Run: npm run db:deploy"
echo "3. Test registration at: collectiva-nevi9999.vercel.app/sign-up"
echo ""
echo "ğŸŒ After deployment, your app will be available at:"
echo "   https://collectiva-nevi9999.vercel.app"
echo ""
echo "ğŸ“ Vercel Free Tier Limits:"
echo "   âœ… 100GB bandwidth/month"
echo "   âœ… 10 second function timeout"
echo "   âœ… Single region deployment (automatic)"
echo "   âš ï¸  Multi-region requires Pro plan ($20/month)"
echo ""
echo "ğŸ“– For detailed instructions, see: DEPLOYMENT.md"
echo ""

# Check if build works
echo "ğŸ”§ Testing production build..."
if npm run build > /dev/null 2>&1; then
    echo "âœ… Build successful - ready for deployment!"
else
    echo "âŒ Build failed - please fix errors before deploying"
fi

echo ""
echo "ğŸ¯ Quick Start:"
echo "1. Push to GitHub: git push origin main"
echo "2. Import to Vercel: vercel.com/new"
echo "3. Your app goes live automatically!"
